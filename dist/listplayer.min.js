!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t(require,exports,module):e.ListPlayer=t()}(this,function(e,t,i){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(){o(this,e)}return s(e,[{key:"on",value:function(e,t,i){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:i}),this}},{key:"once",value:function(e,t,i){function n(){r.off(e,n),t.apply(i,arguments)}var r=this;return n._=t,this.on(e,n,i)}},{key:"emit",value:function(e){var t=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),n=0,r=i.length;for(n;r>n;n++)i[n].fn.apply(i[n].ctx,t);return this}},{key:"off",value:function(e,t){var i=this.e||(this.e={}),n=i[e],r=[];if(n&&t)for(var o=0,s=n.length;s>o;o++)n[o].fn!==t&&n[o].fn._!==t&&r.push(n[o]);return r.length?i[e]=r:delete i[e],this}}]),e}(),u=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,t);var i=n(this,Object.getPrototypeOf(t).call(this));return i.tracks=(e.tracks||[]).map(function(e){return"string"==typeof e?{src:e}:e}),i.loopTracks=e.loopTracks||!0,i.el=i._injectAudioElement(),i.index=0,i._loadTrack(),i.advanced&&i._loadAudioContext(),i}return r(t,e),s(t,[{key:"play",value:function(){return this.emit("play"),this._loadTrack(),this.el.play()}},{key:"pause",value:function(){return this.emit("pause"),this.el.pause()}},{key:"next",value:function(){this.emit("next"),this.index++,this.index>this.tracks.length&&(this.loopTracks?this.index=0:(this.index--,this.emit("error","you are on the last track"))),this._loadTrack(),this.playing()&&this.play()}},{key:"prev",value:function(){this.emit("prev"),this.index--,this.index<0&&(this.loopTracks?this.index=this.tracks.length:(this.index++,this.emit("error","you are on the first track"))),this._loadTrack(),this.playing()&&this.play()}},{key:"playing",value:function(){return!this.el.paused}},{key:"seek",value:function(e){return e?(this.emit("seek",e),void(this.el.currentTime=e)):this.el.currentTime}},{key:"_injectAudioElement",value:function(){var e=document.createElement("audio");return document.body.appendChild(e),e.style.display="none",e}},{key:"_loadTrack",value:function(){if(this._loadedTrack===this.index)return void(this.el.currentTime=0);this.el.innerHTML="",this.currentTrack=this.tracks[this.index];var e=document.createElement("source");e.src=this.currentTrack.src,e.type="audio/mp3",this.el.appendChild(e),this.el.load(),this._loadedTrack=this.index}},{key:"_loadAudioContext",value:function(){var e=window.AudioContext||window.webkitAudioContext;return e?(this.ctx=new e,void(this.src=this.ctx.createMediaElementSource(this.el))):this.emit("error","web audio api unsupported")}}]),t}(a);return u});